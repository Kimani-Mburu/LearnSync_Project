{% extends 'base.html' %}
{% load static %}
{% block extra_stylesheets %}{% endblock extra_stylesheets %}
{% block main %}
<div class="container mt-4">
    <h1 style="font-size: 24px; font-weight: bold; color: #007bff; margin-bottom: 20px;">Search Results for "{{ query }}"</h1>

    <form action="{% url 'learnsync_app:search_results' %}" method="GET" style="position: relative;">
        <input type="text" name="search" id="search-input" placeholder="Search papers, theses, and more" style="width: 100%; padding: 12px; font-size: 16px; border: 2px solid #ccc; border-radius: 20px;">
        <button type="submit" style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%); background-color: transparent; border: none;">
            <i class="bi bi-search" style="font-size: 24px; color: #007bff;"></i>
        </button>
    </form>

    <div class="row mt-4">
        {% if search_results %}
            {% for result in search_results %}
                <div class="col-md-4 mb-4">
                    <div class="card shadow-sm" style="border-radius: 5px; padding: 7px; transition: box-shadow 0.3s, transform 0.3s;" onmouseover="this.style.boxShadow='0 8px 16px rgba(0, 0, 0, 0.4)'; this.style.transform='scale(1.05)'" onmouseout="this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)'; this.style.transform='scale(1)'">
                        <!-- You can replace the following image source with your actual image URL -->
                        <img src="{% static 'img/img.jpg' %}" alt="{{ result.title }}" class="card-img-top" style="border-radius: 5px; padding: 5px; width: 100%;">
                        <div class="card-body">
                            <h4 class="card-title" style="font-size: 16px; font-weight: bold;">{{ result.title }}</h4>
                            <p class="card-text" style="font-size: 12px;">Category: <span style="color: blue;">{{ result.category }}</span> | Authors: <span style="color: green;">{{ result.authors.all|join:", " }}</span></p>
                            <p class="card-text" style="font-size: 12px;">Abstract: {{ result.abstract }}</p>
                            <p class="card-text" style="font-size: 12px;"><span style="font-style: italic; font-weight: bold;">Keywords:</span> {{ result.tags.all|join:", " }}</p>
                            <a href="{{ result.get_absolute_url }}" class="btn btn-primary" style="font-size: 12px; margin-top: 10px;">Access</a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>No results found.</p>
        {% endif %}
    </div>
</div>



{% endblock main %}

{% block extra_scripts %}
<script>
    const searchInput = document.getElementById('search-input');
    const suggestionsList = document.getElementById('suggestions-list');
  
    searchInput.addEventListener('input', function() {
      const query = searchInput.value;
      if (query.trim() !== '') {
        fetch(`/search_suggestions/?query=${query}`)
          .then(response => response.json())
          .then(suggestions => {
            suggestionsList.innerHTML = '';
            suggestions.forEach(suggestion => {
              const listItem = document.createElement('li');
              listItem.textContent = suggestion.title;
              suggestionsList.appendChild(listItem);
            });
          });
      } else {
        suggestionsList.innerHTML = '';
      }
    });
  </script>
  
{% endblock extra_scripts %}